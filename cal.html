<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Líquidos</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { box-sizing: border-box; }
html, body { height: 100%; margin: 0; }
body {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    font-family: 'Roboto', sans-serif;
    background-color: #121212;
    color: #fff;
}
.wrapper { display: flex; flex-direction: column; min-height: 100vh; }

.container {
    background: #1e1e1e;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.5);
    max-width: 400px;
    width: 90%;
    margin: 20px auto;
}
h1 { text-align: center; margin-bottom: 20px; font-weight: 700; color: #ff9800; }
label { display: block; margin-bottom: 5px; font-weight: 500; }
input {
    width: 100%;
    padding: 12px;
    margin-bottom: 5px;
    border-radius: 10px;
    border: 1px solid #333;
    background-color: #2c2c2c;
    color: #fff;
    font-size: 16px;
    outline: none;
    transition: 0.3s;
}
input.error { border-color: #ff4d4d; }
.error-message {
    font-size: 12px;
    color: #ff4d4d;
    margin-bottom: 10px;
    display: none;
}
.result { margin-top: 20px; }
.result-box {
    background: #2c2c2c;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    font-size: 18px;
    margin-bottom: 10px;
}
.icon { margin-right: 8px; color: #ff9800; }
.legend { margin-top: 10px; font-size: 12px; color: #aaa; text-align: center; }

/* Barras tipo régua */
.ruler-container { background: #333; border-radius: 10px; overflow: hidden; height: 25px; margin: 10px 0; position: relative; }
.ruler-total { background: #555; width: 100%; height: 100%; position: absolute; top: 0; left: 0; }
.ruler-current { background: #ff9800; height: 100%; width: 0%; position: absolute; top: 0; left: 0; transition: width 0.5s ease; }
.ruler-consumo { background: #ff4d4d; height: 100%; width: 0%; position: absolute; top: 0; left: 0; transition: left 0.5s ease, width 0.5s ease; }
.ruler-label { display: flex; justify-content: space-between; font-size: 14px; margin-top: 5px; }

.footer {
    text-align: center;
    font-size: 12px;
    color: #aaa;
    margin-top: 10px;
    padding: 10px 0;
}
@media (max-width: 500px) {
    .container { padding: 20px; width: 95%; }
    .result-box { font-size: 16px; padding: 12px; }
}
</style>
</head>
<body>
<div class="wrapper">
<div class="container">
    <h1><i class="fas fa-tint icon"></i>Calculadora de Líquidos</h1>

    <div class="input-group">
        <label for="altura"><i class="fas fa-ruler-vertical icon"></i>Altura do Líquido (cm)</label>
        <input type="number" id="altura" placeholder="Ex: 150" min="0">
        <div class="error-message" id="altura-error">Por favor, insira um número válido.</div>
    </div>

    <div class="input-group">
        <label for="anterior"><i class="fas fa-tint icon"></i>Volume anterior (opcional)</label>
        <input type="number" id="anterior" placeholder="Ex: 4000" min="0">
        <div class="error-message" id="anterior-error">Por favor, insira um número válido ou deixe em branco.</div>
    </div>

    <div class="result" id="resultado"></div>
    <div class="legend">
        A conta é calculada com base em um tanque cilíndrico horizontal de 300 cm de comprimento e 80 cm de raio, com 6.000 litros de armazenamento.
    </div>
</div>

<div class="footer">Desenvolvido por GB | 2025</div>
</div>

<script>
const alturaInput = document.getElementById('altura');
const anteriorInput = document.getElementById('anterior');

alturaInput.addEventListener('input', calcularLitros);
anteriorInput.addEventListener('input', calcularLitros);

function formatarNumero(numero) {
    return numero.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function calcularLitros() {
    const altura = parseFloat(alturaInput.value);
    const anterior = parseFloat(anteriorInput.value);

    alturaInput.classList.remove('error');
    anteriorInput.classList.remove('error');
    document.getElementById('altura-error').style.display = 'none';
    document.getElementById('anterior-error').style.display = 'none';

    let temErro = false;

    if (isNaN(altura) || altura <= 0) {
        alturaInput.classList.add('error');
        document.getElementById('altura-error').style.display = 'block';
        temErro = true;
    }

    if (anteriorInput.value !== "" && (isNaN(anterior) || anterior < 0)) {
        anteriorInput.classList.add('error');
        document.getElementById('anterior-error').style.display = 'block';
        temErro = true;
    }

    if (temErro) {
        document.getElementById('resultado').innerHTML = '';
        return;
    }

    const raio = 80;
    const comprimento = 300;
    const capacidadeTotal = 6000;

    if (altura > 2*raio) {
        alturaInput.classList.add('error');
        document.getElementById('altura-error').innerText = "A altura não pode ser maior que o diâmetro do tanque (160 cm).";
        document.getElementById('altura-error').style.display = 'block';
        return;
    }

    const h = altura;
    const r = raio;
    const L = comprimento;

    const parte1 = r*r*Math.acos((r-h)/r);
    const parte2 = (r-h)*Math.sqrt(2*r*h - h*h);
    const volumeCm3 = L * (parte1 - parte2);

    const litros = volumeCm3 / 1000;
    const percentual = (litros / capacidadeTotal) * 100;
    const espacoDisponivel = capacidadeTotal - litros;

    let resultadoHTML = `<div class="result-box"><i class="fas fa-tint icon"></i> Volume: <strong>${formatarNumero(litros)} litros</strong></div>`;
    resultadoHTML += `<div class="result-box"><i class="fas fa-percent icon"></i> Percentual do tanque: <strong>${formatarNumero(percentual)}%</strong></div>`;

    let consumoPercent = 0;
    let consumoValor = 0;
    if (!isNaN(anterior) && anterior >= 0) {
        consumoValor = anterior - litros;
        consumoPercent = (consumoValor / capacidadeTotal) * 100;
        if (consumoPercent < 0) consumoPercent = 0;
    }

    const leftConsumo = percentual; 

    resultadoHTML += `
        <div class="ruler-label">
            <span>Atual</span>
            <span>Total</span>
        </div>
        <div class="ruler-container">
            <div class="ruler-total"></div>
            <div class="ruler-current" style="width:${percentual}%"></div>
            <div class="ruler-consumo" style="width:${consumoPercent}%; left:${leftConsumo}%"></div>
        </div>
    `;

    if (!isNaN(anterior) && anterior >= 0) {
        resultadoHTML += `<div class="result-box"><i class="fas fa-fire icon" style="color:#ff4d4d;"></i> Consumo: <strong>${formatarNumero(consumoValor)} litros</strong></div>`;
    }

    resultadoHTML += `<div class="result-box"><i class="fas fa-pie-chart icon"></i> Espaço disponível: <strong>${formatarNumero(espacoDisponivel)} litros</strong></div>`;

    // Mensagens de alerta
    if (altura < 78) {
        resultadoHTML += `<div class="result-box" style="color:#ff9800;">Efetuar compra de líquido em breve</div>`;
    }
    if (altura < 50) {
        resultadoHTML += `<div class="result-box" style="color:#ff0000;">Efetuar compra urgente</div>`;
    }
    if (altura < 30) {
        resultadoHTML += `<div class="result-box" style="color:#ff0000;">Armazenamento crítico. Efetuar compra imediata!</div>`;
    }

    document.getElementById('resultado').innerHTML = resultadoHTML;
}
</script>
</body>
</html>
